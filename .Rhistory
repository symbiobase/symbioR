arrange(collection_latitude, sample.ID, (abundance))
devtools::load_all(".")
df2 <- dplyr::left_join(df, cols, by="seq.ID") |>
arrange(collection_latitude, sample.ID, (abundance))
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
df2
devtools::load_all(".")
df2 <- dplyr::left_join(df, cols, by="seq.ID") |>
arrange(collection_latitude, sample.ID, (abundance))
df2
df2 <- dplyr::left_join(df, cols, by="seq.ID") |>
arrange(collection_latitude, sample.ID, desc(abundance))
df2
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
df2 <- dplyr::left_join(df, cols, by="seq.ID") |> arrange((collection_latitude), host_genus, sample.ID, (abundance))
df2
df2 <- dplyr::left_join(df, cols, by="seq.ID") |> arrange((collection_latitude), host_genus, sample.ID, rev(abundance))
df2
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
df2
df2 <- dplyr::left_join(df, cols, by="seq.ID") |> ungroup() |>
group_by(sample.ID) |>
arrange(abundance)
df2
df2 <- dplyr::left_join(df, cols, by="seq.ID") |> ungroup() |>
group_by(sample.ID) |>
arrange(desc(abundance))
df2
plot_seqs2(input=samples_new, folder=folder_path, format="plotly")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
rm(plot_seqs2)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all()
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo")
seqs <- extract_seqs_wide(folder_path)
folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo")
seqs <- extract_seqs_wide(folder_path)
folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo")
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", threshold=7500)
?extract_seqs_long
load(extract_seqs_long)
extract_seqs_long
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
traceback()
devtools::load_all(".")
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
traceback()
devtools::load_all(".")
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
devtools::load_all(".")
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
devtools::load_all(".")
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
traceback()
devtools::load_all(".")
traceback()
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", threshold=7500)
# dropped samples:
droplist_qc_seqyield <- setdiff(samples$sample.ID, samples_new$sample.ID)
# check if working:
samples_new |> group_by(seq.ID) |> summarise(sum=sum(abundance))
library(tidyverse)
folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo")
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", threshold=7500)
# dropped samples:
droplist_qc_seqyield <- setdiff(samples$sample.ID, samples_new$sample.ID)
# check if working:
samples_new |> group_by(seq.ID) |> summarise(sum=sum(abundance))
# by name (this include partial matching):
remove_sample_list <- c("AU18_0260", "AU18_0592", "AU18_1039", "AU18_0332")
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", drop_samples=remove_sample_list)
# dropped samples:
droplist_qc_names <- setdiff(samples$sample.ID, samples_new$sample.ID)
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# dropped samples:
droplist_qc_profiles <- setdiff(samples$sample.ID, samples_new$sample.ID)
samples_new <- extract_seqs_long(folder_path,
type="relative",
drop_samples=remove_sample_list,
onlyProfiles=TRUE)
# samples unique to each list
droplist_profiles_unique  <- setdiff(droplist_qc_profiles$sample.ID, droplist_qc_seqyield$sample.ID) # unique to profiles QC
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
metadf <- read.csv(paste0(folder_path, "/", metadata)) |> rename(sample.ID=sample_name)
metadf <- read.csv(paste0(folder, "/", metadata_20230120T102936.csv)) |> rename(sample.ID=sample_name)
metadf <- read.csv(paste0(folder_path, "/", metadata_20230120T102936.csv)) |> rename(sample.ID=sample_name)
metadf <- read.csv(paste0(folder_path, "/", "metadata_20230120T102936.csv")) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
dplyr::left_join(df, cols, by="seq.ID") |> ungroup() |>
group_by(sample.ID) |>
arrange(desc(abundance))
devtools::load_all(".")
dplyr::left_join(df, cols, by="seq.ID") |> ungroup() |>
group_by(sample.ID) |>
arrange(desc(abundance))
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
seqs_viewer()
devtools::load_all(".")
document()
library(devtools)
document()
check()
usethis::use_version()
seqs_viewer()
devtools::load_all(".")
seqs_viewer()
seqs_viewer(folder_path)
?extract_metadata
extract_metadata
devtools::load_all(".")
seqs_viewer(folder_path)
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
extract_metadata(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
devtools::load_all(".")
seqs_viewer(folder_path)
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
seqs_viewer(folder_path)
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
styler:::style_selection()
styler:::style_active_file()
devtools::load_all(".")
styler:::style_active_file()
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
extract_metadata
devtools::load_all(".")
extract_metadata
seqs_viewer(folder_path)
extract_metadata
# Your code to process the default_folder, similar to what you do in observeEvent
plot_data_new <- extract_seqs_long(folder_path, type = "absolute")
plot_data_new
unique(plot_data_new$sample.ID)
data.frame(
sample.id=unique(plot_data_new$sample.ID))
unique(plot_data_new$sample.ID)metadata_new
metadata_new
metadata_new
metadata_new <- extract_metadata(folder_path) %>% dplyr::select("sample.ID", "sample_uid", "host_genus", "host_species", "collection_location","collection_longitude", "collection_latitude")
metadata_new <- extract_metadata(folder_path) %>% dplyr::select("sample.ID", "sample_uid", "host_genus", "host_species", "collection_longitude", "collection_latitude")
metadata_new
plot_data_new2
plot_data_new2 <- extract_seqs_wide(folder_path, type = "absolute")
plot_data_new2
nrow(plot_data_new2)
# Your code to process the default_folder, similar to what you do in observeEvent
plot_data_new <- extract_seqs_long(folder_path, type = "absolute")
nrow(plot_data_new)
plot_data_new
extract_seqs_long
metadata_new
cities <- c("Brussels", "Milan", "Paris", "Rome", "Den Haag")
random_cities <- sample(cities, 154, replace = TRUE)
random_cities
metadata_new |> mutate(location= random_cities)
random_cities <- sample(cities, 1548, replace = TRUE)
random_cities <- sample(cities, 158, replace = TRUE)
metadata_new |> mutate(location= random_cities)
newmeta <- metadata_new |> mutate(location= random_cities)
read.csv(newmeta, "newmeta.csv")
View(newmeta)
newmeta <- metadata_new |> mutate(location= random_cities)
newmeta
str(newmeta)
write.csv(newmeta, "newmeta.csv")
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
usethis::use_version()
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
usethis::use_version()
devtools::load_all(".")
usethis::use_version()
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
devtools::load_all(".")
seqs_viewer(folder_path)
usethis::use_version()
seqs_viewer(folder_path)
?rename
use_pipe()
devtools::load_all(".")
extract_plot_colors
