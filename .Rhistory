#scale_y_discrete(expand=c(0,0))+
geom_bar(data = bar_data,
aes(x = factor(Category), y = Value, fill = Group), color = "black", linewidth = 0.1,
stat="identity",width=1,position=position_stack(reverse=F)) +
geom_text(data = bar_data, aes(label=round(Category)),position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
t2
ggplot() + theme_bw() +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = bar_data,
aes(x = factor(Category), y = Value, fill = Group), color = "black", linewidth = 0.1,
stat="identity",width=1,position=position_stack(reverse=F)) +
geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
library(ggh4x)
t=head(USArrests,20)
t2=data.frame(V1=rownames(t)[row(t)],V2=colnames(t)[col(t)],V3=unname(do.call(c,t)))
hc=hclust(dist(t))
ggplot(t2,aes(x=factor(V1,level=rownames(t)),y=V3,fill=V2))+
geom_bar(stat="identity",width=1,position=position_stack(reverse=F))+
geom_text(aes(label=round(V3)),position=position_stack(vjust=.5,reverse=F),size=3)+
scale_x_dendrogram(hclust=hc)
tmp <- matrix(rnorm(130*10), 130, 10)
distmatrix <- dist(tmp, method = "euclidian")
hclust_dist <- hclust(distmatrix, method="average")
ggplot() + theme_bw() +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = bar_data,
aes(x = factor(Category), y = Value, fill = Group), color = "black", linewidth = 0.1,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = bar_data,
aes(x = factor(Category), y = Value, fill = Group), color = "black", linewidth = 0.1,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
rlang::last_trace()
hclust_dist <- hclust(dist(plot_data_new))
hclust_dist
hclust_dist <- hclust(dist(plot_data_new_short))
ggplot() + theme_bw() +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = bar_data,
aes(x = factor(Category), y = Value, fill = Group), color = "black", linewidth = 0.1,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
hclust_dist
bar_data
ggplot() + theme_bw() +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(Category), y = Value, fill = Group), color = "black", linewidth = 0.1,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(Category), y = Value, fill = Group), color = "black", linewidth = 0.1,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = (Category), y = Value, fill = Group), color = "black", linewidth = 0.1,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
head(plot_data_new)
ggplot() + theme_bw() +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() + xlab("false") +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() + xlab(false) +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() + xlab("") +
#scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
#theme(, strip.background = element_blank(), strip.text.x = element_blank(),
theme(
axis.text=element_text(color="black",size=11),
axis.text.x=element_text(angle=90,hjust=1,vjust=.5),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
#theme(, strip.background = element_blank(), strip.text.x = element_blank(),
theme(
axis.text.x = element_blank(),
axis.text.x=element_text(angle=90,hjust=1,vjust=.5),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
#theme(, strip.background = element_blank(), strip.text.x = element_blank(),
theme(
axis.text=element_text(color="black",size=11),
axis.text.x = element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
hclust_dist <- hclust(vegdist(plot_data_new_short))
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
#theme(, strip.background = element_blank(), strip.text.x = element_blank(),
theme(
axis.text=element_text(color="black",size=11),
axis.text.x = element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
hclust_dist <- hclust(vegdist(plot_data_new_short, "bray"))
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
#theme(, strip.background = element_blank(), strip.text.x = element_blank(),
theme(
axis.text=element_text(color="black",size=11),
axis.text.x = element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
hclust_dist
cut=cutree(hclust_dist,8)
dend=color_branches(as.dendrogram(hc),k=length(unique(cut)),col=labelcolor[unique(cut[labels])])
circos.clear()
library(circlize)
library(vegan) # for reorder.hclust (may be masked by `seriation`)
library(dendextend)
install.packages("circlize")
library(circlize)
circos.clear()
png("a.png",w=2500,h=2500,res=300)
circos.par(cell.padding=c(0,0,0,0),gap.degree=5,points.overflow.warning=F)
circos.initialize("a",xlim=c(0,nrow(t)))
circos.track(ylim=c(0,1),bg.border=NA,track.height=.28,track.margin=c(.01,0),
panel.fun=function(x,y)for(i in 1:nrow(t))circos.text(i-.5,0,labels[i],adj=c(0,.5),facing="clockwise",niceFacing=T,cex=.65,col=labelcolor[cut[labels[i]]]))
panel.fun=function(x,y)for(i in 1:nrow(t))circos.text(i-.5,0,labels[i],adj=c(0,.5),facing="clockwise",niceFacing=T,cex=.65)
circos.track(ylim=c(0,1),bg.border=NA,track.height=.28,track.margin=c(.01,0),
circos.track(ylim=c(0,1),track.margin=c(0,0),track.height=.35,bg.lty=0,panel.fun=function(x,y){
mat=as.matrix(t)
pos=1:nrow(mat)-.5
barwidth=1
for(i in 1:ncol(mat)){
seq1=rowSums(mat[,seq(i-1),drop=F])
seq2=rowSums(mat[,seq(i),drop=F])
circos.rect(pos-barwidth/2,if(i==1){0}else{seq1},pos+barwidth/2,seq2,col=barcolor[i],border="gray20",lwd=.1)
}
for(i in 1:ncol(mat)){
seq1=rowSums(mat[,seq(i-1),drop=F])
seq2=rowSums(mat[,seq(i),drop=F])
lab=round(100*t[,i])
lab[lab<=1]=""
circos.text(pos,if(i==1){seq1/2}else{seq1+(seq2-seq1)/2},labels=lab,col="gray10",cex=.4,facing="downward")
}
})
circos.track(ylim=c(0,1),bg.border=NA,track.height=.28,track.margin=c(.01,0),
panel.fun=function(x,y)for(i in 1:nrow(t))circos.text(i-.5,0,labels[i],adj=c(0,.5),facing="clockwise",niceFacing=T,cex=.65))
library(tidyverse)
library(ggplot2)
library(vegan)
library(ggdendro)
library(cowplot)
library(dendextend)
# 1. Prepare Data for Dendrogram
hclust_dist <- hclust(vegdist(plot_data_new_short, "bray"))
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
#scale_y_discrete(expand=c(0,0))+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
#geom_text(data = bar_data, aes(label=round(Abundance)), position=position_stack(vjust=.5,reverse=F),size=3)+
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
#theme(, strip.background = element_blank(), strip.text.x = element_blank(),
theme(
axis.text=element_text(color="black",size=11),
axis.text.x = element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
theme(
axis.text=element_text(color="black",size=11),
axis.text.x = element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
ggplot() + theme_bw() + xlab("") +
#scale_x_dendrogram(hclust=hclust_dist)+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
theme(
axis.text=element_text(color="black",size=11),
axis.text.x = element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
ggplot() + theme_bw() + xlab("") +
#scale_x_dendrogram(hclust=hclust_dist)+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID), color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
theme(
axis.text=element_text(color="black",size=11),
axis.text.x = element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
ggplot() + theme_bw() + xlab("") +
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID),
color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID),
color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
theme(
axis.text=element_text(color="black",size=11),
axis.text.x = element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
ggplot() + theme_bw() + xlab("") +
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID),
color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F))
ggplot() + theme_bw() + xlab("") +
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID),
color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F))
ggplot() + theme_bw() +
geom_bar(data = plot_data_new, aes(x = factor(sample.ID), y = abundance, fill = seq.ID),
color = "black", linewidth = 0.1, show.legend=FALSE, stat="identity", width=1, position=position_stack(reverse=F))
plot_data_new
p <- ggplot() + theme_bw() +
geom_bar(data = plot_data_new, aes(x = factor(sample.ID), y = abundance, fill = seq.ID),
color = "black", linewidth = 0.1, show.legend=FALSE, stat="identity", width=1, position=position_stack(reverse=F))
p
str(p)
plot_data_new
pggplot() + theme_bw() +
geom_bar(data = plot_data_new, aes(x = (sample.ID), y = abundance, fill = seq.ID),
show.legend=FALSE, stat="identity")
ggplot() + theme_bw() +
geom_bar(data = plot_data_new, aes(x = (sample.ID), y = abundance, fill = seq.ID),
show.legend=FALSE, stat="identity")
ggplot() + theme_bw() +
geom_bar(
data = filtered_data,
aes(
x = sample.ID, y = abundance,
fill = seq.ID,
group = abundance
),
color = "black", linewidth = 0.1, position = position_fill(reverse = TRUE),
show.legend = FALSE, stat = "identity"
) + scale_y_reverse() +
#theme(legend.position = "bottom", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
theme(legend.position = "bottom", axis.text.x = element_blank(),
strip.background = element_blank(), strip.text.x = element_blank())
plot_data_new <- extract_seqs_long(folder_path, type = "absolute")
colour.seqs_new <- extract_plot_colors(folder_path)
its2.type.names_new <- extract_its2_names(folder_path)
plot_data_new_short <- extract_seqs(folder_path, type = "absolute")
hclust_dist <- hclust(vegdist(plot_data_new_short, "bray"))
ggplot() + theme_bw() +
geom_bar(data = plot_data_new, aes(x = (sample.ID), y = abundance, fill = seq.ID),
show.legend=FALSE, stat="identity")
ggplot() + theme_bw() + xlab("") +
scale_x_dendrogram(hclust=hclust_dist)+
geom_bar(data = plot_data_new,
aes(x = factor(sample.ID), y = abundance, fill = seq.ID),
color = "black", linewidth = 0.1, show.legend=FALSE,
stat="identity",width=1,position=position_stack(reverse=F)) +
theme(
axis.text=element_text(color="black",size=11),
axis.text.x = element_blank(),
axis.text.y=element_blank(),
axis.ticks=element_blank(),
axis.ticks.length=unit(14,"pt"), # height of dendrogram
axis.title=element_blank(),
legend.justification=c(0,1),
legend.key=element_rect(fill=NA), # remove gray border around color squares
legend.margin=margin(-6,0,0,0),
legend.position=c(0,1),
legend.title=element_blank(),
panel.background=element_rect(fill="white"),
plot.margin=margin(5,0,5,5)
)
