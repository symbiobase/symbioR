"H18B10_ES22OT", "C3lk", 0, 27
)
# Ridgeline plot
ggplot(df, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline() +
scale_y_discrete(limits = unique(df$sample.ID)) +
labs(x = "numeric.ID", y = "sample.ID")
df <- tribble(
~sample.ID, ~seq.ID, ~abundance, ~numeric.ID,
"H18B10_ES22OT", "C8", 0.514, 49,
"H18B10_ES22OT", "C78c", 0, 45,
"H18B10_ES22OT", "C1", 0.0542, 1,
"H18B10_ES22OT", "C79", 0, 46,
"H18B10_ES22OT", "C8a", 0.282, 50,
"H18B10_ES22OT", "C35.3", 0, 18,
"H18B10_ES22OT", "C35.1", 0, 17,
"H18B10_ES22OT", "C42.2", 0.0438, 31,
"H18B10_ES22OT", "C54l", 0, 42,
"H18B10_ES22OT", "C3lk", 0, 27
) |> mutate(sample.ID=as.factor(sample.ID))
# Ridgeline plot
ggplot(df, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline() +
scale_y_discrete(limits = unique(df$sample.ID)) +
labs(x = "numeric.ID", y = "sample.ID")
# Ridgeline plot
ggplot(df, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline() +
#  scale_y_discrete(limits = unique(df$sample.ID)) +
labs(x = "numeric.ID", y = "sample.ID")
# Ridgeline plot
ggplot(df, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline()
ggplot(plot_data, aes(x = numeric.ID, y = sample.ID, height = ..density..)) +
geom_density_ridges(rel_min_height = 0.1, scale = 4) +
theme_ridges() + scale_fill_brewer(palette = 4)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
mutate(seq.ID = as.factor(seq.ID)) |>
filter(sample.ID %in% levels(sample.ID)[1:20]) |>
mutate(abundance=round(abundance*100))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID))
ggplot(plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline()
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>5)
ggplot(plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline()
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance<5)
ggplot(plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline()
plot_data
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01)
ggplot(plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline()
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.05)
ggplot(plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline()
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.05) |>
complete(seq.ID)
plot_data
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.05)
plot_data
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.05) |>
complete(seq.ID, sample.ID)
plot_data
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.05) |>
complete(seq.ID, sample.ID) |>
replace_na(list(abundance = 0))
ggplot(plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline()
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.05) |>
complete(seq.ID, sample.ID) |>
replace_na(list(abundance = 0.001))
ggplot(plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline()
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.05) |>
complete(seq.ID, sample.ID) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot(plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance)) +
geom_ridgeline()
ggplot() + theme_ridges() +
geom_ridgeline(plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.1) |>
complete(seq.ID, sample.ID) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
filter(sample.ID %in% levels(sample.ID)[1:20]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.1) |>
complete(seq.ID, sample.ID) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
library(symportalfunctions)
library(tidyverse)
library(ggridges)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(sample.ID %in% levels(sample.ID)[1:20]) |>
filter(abundance>0.1) |>
complete(seq.ID, sample.ID) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
filter(abundance>0.1) |>
complete(seq.ID, sample.ID) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
filter(abundance>0.1) |>
complete(seq.ID) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.1) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
library(symportalfunctions)
library(tidyverse)
library(ggridges)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.1) |>
complete(seq.ID, sample.ID) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
library(symportalfunctions)
library(tidyverse)
library(ggridges)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.1) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
library(symportalfunctions)
library(tidyverse)
library(ggridges)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
ggplot() + theme_ridges() +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID,  height = abundance))
mutate(group="group"")
ggplot() + theme_ridges() + ylab("") +
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group")
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y=group, height = abundance))
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
group_by(seq.ID) |> arrange(abundance) |> ungroup() |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group")
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
group_by(seq.ID) |> arrange(abundance) |> ungroup() |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group")
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
arrange(abundance) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group")
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group")
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance))
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance), rel_min_height = 0.01)
ggplot() + theme_ridges() + ylab("") +
geom_density_ridges(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance), rel_min_height = 0.01)
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance, fill=sample.ID))
?geom_ridgeline
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance, fill=sample.ID), show.legend=FALSE)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*2)
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance, fill=sample.ID), show.legend=FALSE)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*4)
library(symportalfunctions)
library(tidyverse)
library(ggridges)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*4)
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance, fill=sample.ID), show.legend=FALSE)
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance), show.legend=FALSE)
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance, fill=sample.ID), alpha=0.4, show.legend=FALSE)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*2)
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance, fill=sample.ID), alpha=0.4, show.legend=FALSE)
# Fit normal distribution to 'abundance' for each 'sample.ID'
fit_results <- plot_data %>%
group_by(sample.ID) %>%
do(fit = fitdist(.$abundance, "norm"))
install.packages("fitdistrplus")
library(fitdistrplus)
# Fit normal distribution to 'abundance' for each 'sample.ID'
fit_results <- plot_data %>%
group_by(sample.ID) %>%
do(fit = fitdist(.$abundance, "norm"))
fit_results
fit_params <- fit_results %>%
rowwise() %>%
mutate(mean = fit$estimate['mean'],
sd = fit$estimate['sd'])
fit_params
ggplot(plot_data, aes(x=abundance)) +
geom_histogram(aes(y=..density..), bins=30, alpha=0.5) +
facet_wrap(~sample.ID, scales="free") +
geom_line(data=fit_results,
aes(x=abundance, y=dnorm(abundance, mean=fit$estimate['mean'], sd=fit$estimate['sd']),
color=sample.ID),
stat="identity") +
labs(x = "Abundance", y = "Density", title = "Fitted Normal Distributions by sample.ID")
plot_data
fit_params
# Fit normal distribution to 'abundance' for each 'sample.ID'
fit_results <- plot_data %>%
group_by(sample.ID, seq.ID) %>%
do(fit = fitdist(.$abundance, "norm"))
fit_params <- fit_results %>%
rowwise() %>%
mutate(mean = fit$estimate['mean'],
sd = fit$estimate['sd'])
plot_data |> filter(sample.ID = "H00B06_ES22OT")
plot_data |> filter(sample.ID == "H00B06_ES22OT")
tmp <- plot_data |> filter(sample.ID == "H00B06_ES22OT")
tmp
# Fit normal distribution to 'abundance' for each 'sample.ID'
fit_results <- tmp %>%
do(fit = fitdist(.$abundance, "norm"))
fit_results
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance*2, fill=sample.ID), alpha=0.4, show.legend=FALSE)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group")
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*2)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*4)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C")
library(symportalfunctions)
library(tidyverse)
library(ggridges)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*4)
plot_data <- symportalfunctions::extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*2)
library(symportalfunctions)
load_all()
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*2)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C")
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C", cutoff=100)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C")
library(symportalfunctions)
library(tidyverse)
library(ggridges)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*2)
ggplot() + theme_ridges() + ylab("") +
geom_ridgeline(data=plot_data, aes(x = numeric.ID, y = sample.ID, height = abundance, fill=sample.ID), alpha=0.4, show.legend=FALSE)
library(fitdistrplus)
# Fit normal distribution to 'abundance' for each 'sample.ID'
fit_results <- plot_data %>%
group_by(sample.ID, seq.ID) %>%
do(fit = fitdist(.$abundance, "norm"))
tmp <- plot_data |> filter(sample.ID == "H00B06_ES22OT")
tmp
library(symportalfunctions)
library(tidyverse)
library(ggridges)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001))
library(symportalfunctions)
library(tidyverse)
library(ggridges)
plot_data <- extract_seqs_long(folder="/Users/rof011/symbiodinium/20220919T102058_esampayo", type="relative", clade="C") |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
mutate(sample.ID = as.factor(sample.ID)) |>
filter(abundance>0.01) |>
complete(seq.ID, sample.ID) |>
filter(sample.ID %in% levels(sample.ID)[1:10]) |>
mutate(numeric.ID = as.numeric((as.factor(seq.ID)))) |>
replace_na(list(abundance = 0.001)) |>
mutate(group="group") |>
mutate(abundance=abundance*2)
