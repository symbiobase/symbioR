#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
devtools::load_all(".")
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
# threshold
drop_thresh <- data.frame(
sample_names=absolute$sample_name,
rowsums=rowSums(absolute[,2:ncol(absolute)])) |>
filter(rowsums > threshold)
drop_thresh$sample_names
absolute$sample_names
absolute$sample_name
devtools::load_all(".")
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", threshold=7500)
samples_new
samples
folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo")
seqs <- extract_seqs_wide(folder_path)
#------------------------------------------------------------------@
# 1) QC drop by seq_yield
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", threshold=7500)
# dropped samples:
droplist_qc_seqyield <- setdiff(samples$sample.ID, samples_new$sample.ID)
# check if working:
samples_new |> group_by(seq.ID) |> summarise(sum=sum(abundance))
#------------------------------------------------------------------@
# 2) drop samples by samplename
# by name (this include partial matching):
remove_sample_list <- c("AU18_0260", "AU18_0592", "AU18_1039", "AU18_0332")
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", drop_samples=remove_sample_list)
# dropped samples:
droplist_qc_names <- setdiff(samples$sample.ID, samples_new$sample.ID)
#------------------------------------------------------------------@
# 3) QC drop by profile
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# dropped samples:
droplist_qc_profiles <- setdiff(samples$sample.ID, samples_new$sample.ID)
#------------------------------------------------------------------@
# combine 1-3
samples_new <- extract_seqs_long(folder_path,
type="relative",
drop_samples=remove_sample_list,
onlyProfiles=TRUE)
# samples unique to each list
droplist_profiles_unique  <- setdiff(droplist_qc_profiles$sample.ID, droplist_qc_seqyield$sample.ID) # unique to profiles QC
# dropped samples:
droplist_qc_profiles <- setdiff(samples$sample.ID, samples_new$sample.ID)
# samples unique to each list
droplist_profiles_unique  <- setdiff(droplist_qc_profiles$sample.ID, droplist_qc_seqyield$sample.ID) # unique to profiles QC
droplist_qc_profiles
samples_new
# add metadata
metadf <- read.csv(paste0(folder, "/", metadata)) |>
dplyr::select(all_of(factors))
metadf
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata=metadata_20230120T102936.csv, factors="host_genus")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv", factors="host_genus")
traceback()
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv", factors="host_genus")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv", factors="host_genus")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv", factors="host_genus")
devtools::load_all(".")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv", factors="host_genus")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv", factors="host_genus")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv", factors="host_genus")
devtools::load_all(".")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv", factors="host_genus")
samples_new
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv", factors="host_genus", host_genus="Acropora")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, metadata="metadata_20230120T102936.csv")
devtools::load_all(".")
samples <- extract_seqs_long(folder_path, type="absolute")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
devtools::load_all(".")
samples <- extract_seqs_long(folder_path, type="absolute")
devtools::load_all(".")
samples <- extract_seqs_long(folder_path, type="absolute")
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata))
metadf
samples_new <- left_join(samples_new, metadf)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata))
samples_new <- left_join(samples_new, metadf, by="sample_name")
metadf
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(folder_path, format="plotly", type="relative")
plot_seqs2(folder_path, format="plotly", type="relative") + facet_wrap(~host_genus)
samples_new
plot_seqs2(folder_path, format="ggplot", type="relative") + facet_wrap(~host_genus)
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
plot_seqs2(folder_path, format="ggplot", type="relative") + facet_wrap(~host_genus)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(samples_new, folder=folder_path, format="ggplot", type="relative", facet="host_genus")
devtools::load_all(".")
devtools::load_all(".")
plot_seqs2(samples_new, folder=folder_path, format="ggplot", type="relative", facet="host_genus")
plot_seqs2(samples_new, folder=folder_path, format="ggplot", facet="host_genus")
devtools::load_all(".")
samples_new
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
samples_new
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
samples_new
plot_seqs2(samples_new, folder=folder_path, format="ggplot", facet="host_genus")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="host_genus")
samples_new
devtools::load_all(".")
samples_new
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="host_genus")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet="location")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="absolute", onlyProfiles=TRUE)
# open metadata file
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
plot_seqs2(input=samples_new, folder=folder_path, format="ggplotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplotly", facet=TRUE)
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
plot <- ggplot2::ggplot() +
ggplot2::theme_bw() +
ggplot2::xlab("") +
ggplot2::geom_bar(data = df2,
ggplot2::aes(x = sample.ID, y = abundance, fill = seq.ID,  group = abundance),
color = "black", linewidth = 0.1,
show.legend = FALSE, position="stack", stat="identity") +
ggplot2::scale_fill_identity() +
ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 90, vjust = 0.5, hjust=1)) +
facet_wrap( ~ host_genus, scales="free_x", ncol=3)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
metadf
df=input
input=samples_new
df=input
cols <- symportalfunctions::extract_plot_colors(folder_path) |>
as.data.frame() |>
dplyr::rename("col"=1) |>
tibble::rownames_to_column("seq.ID")
df2 <- dplyr::left_join(df, cols, by="seq.ID") |>
arrange(sample.ID, seq.ID, desc(abundance))
df2
df2 <- dplyr::left_join(df, cols, by="seq.ID") |>
arrange(collection_latitude, sample.ID, desc(abundance))
df2
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
tail(df2)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
df2 <- dplyr::left_join(df, cols, by="seq.ID") |>
arrange(collection_latitude, sample.ID, (abundance))
devtools::load_all(".")
df2 <- dplyr::left_join(df, cols, by="seq.ID") |>
arrange(collection_latitude, sample.ID, (abundance))
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
df2
devtools::load_all(".")
df2 <- dplyr::left_join(df, cols, by="seq.ID") |>
arrange(collection_latitude, sample.ID, (abundance))
df2
df2 <- dplyr::left_join(df, cols, by="seq.ID") |>
arrange(collection_latitude, sample.ID, desc(abundance))
df2
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="ggplot", facet=TRUE)
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
samples_new <- extract_seqs_long(folder_path, type="relative", onlyProfiles=TRUE)
metadf <- read.csv(paste0(folder, "/", metadata)) |> rename(sample.ID=sample_name)
samples_new <- left_join(samples_new, metadf, by="sample.ID")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
df2 <- dplyr::left_join(df, cols, by="seq.ID") |> arrange((collection_latitude), host_genus, sample.ID, (abundance))
df2
df2 <- dplyr::left_join(df, cols, by="seq.ID") |> arrange((collection_latitude), host_genus, sample.ID, rev(abundance))
df2
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
df2
df2 <- dplyr::left_join(df, cols, by="seq.ID") |> ungroup() |>
group_by(sample.ID) |>
arrange(abundance)
df2
df2 <- dplyr::left_join(df, cols, by="seq.ID") |> ungroup() |>
group_by(sample.ID) |>
arrange(desc(abundance))
df2
plot_seqs2(input=samples_new, folder=folder_path, format="plotly")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly")
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
rm(plot_seqs2)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
devtools::load_all(".")
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=FALSE)
plot_seqs2(input=samples_new, folder=folder_path, format="plotly", facet=TRUE)
