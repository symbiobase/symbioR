---
title: "Visualise seqs"
date: "`r Sys.Date()`"
---

```{css, echo=FALSE}
h1.title {
  font-size: 32px;
}

h1 {
  font-size: 24px;
}

h2 {
  font-size: 22px;
}

h3 {
  font-size: 18px;
  font-weight: normal;
}

h4 {
  font-size: 16px;
  font-style: italic;
  font-weight: normal;
}


figcaption {
  padding: .5em;
  background: lightgrey;
  font-size: 10px;
  font-variant: italic;
}
```


There are three approaches to plotting sequences:



## a) sequence stacked bar graph

`plot_seqs()` takes the symportal function for either `type = "relative"` or `type = "abundance"`, and will accept any distance matrix from `vegan` (see `?vegdist` for details). For example:

```{r, fig.width=20, fig.height=6}

library(symportalfunctions)

folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo") 

plot_seqs(folder_path, type = "relative")

```


You can pass any argument from `?extract_seqs_long` to `plot_seqs` directly to filter before plotting. 
For example: 

filter all seqs < 6000 reads

```{r, fig.width=20, fig.height=6}

folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo") 

plot_seqs(folder_path, type = "relative",  threshold=6000)

```


or only clade D:

```{r, fig.width=20, fig.height=6}

folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo") 

plot_seqs_dendro(folder_path, clade = "D", type = "relative", dist="bray")

```

or only filter to exclude samples between "AU18_0000" to "AU18_0999" 

```{r, fig.width=20, fig.height=6}

folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo") 

plot_seqs(folder_path, type = "relative", drop_samples=sprintf("AU18_%04d", seq(0, 999)))

```

## b) clustered stacked bar graph

`plot_seqs_dendro()` follows the same input and arguments as `plot_seqs()` but groups sample.ID by cluster analysis and returns the dendrogram beneath the stacked bar graph using `scale_dendrogram` via `ggh4x`. 

the argument "dist" accepts any distance matrix from `vegan` (see `method` in `?vegdist` for details)

For example:

```{r, fig.width=20, fig.height=6}

folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo") 

tmp <- plot_seqs_dendro(folder_path, type = "relative", dist="bray")

```

```{r, fig.width=20, fig.height=6}

folder_path <- ("/Volumes/Macintosh HD/Users/rof011/symbiodinium/20230120T102936_esampayo") 

plot_seqs_dendro(folder_path, type = "relative", dist="euclidean")

```

## c) interactive viewer


To launch a shiny interactive viewer, run the following:

```{r eval=FALSE, include=TRUE, class.source = 'fold-show'}


seq_viewer()

```



